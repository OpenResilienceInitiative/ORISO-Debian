apiVersion: v1
kind: ConfigMap
metadata:
  name: userservice-config
  namespace: caritas
data:
  # Database Configuration - Use service names (same namespace)
  SPRING_DATASOURCE_URL: "jdbc:mariadb://mariadb:3306/userservice"
  
  # Keycloak Configuration - Use service names
  KEYCLOAK_AUTH_SERVER_URL: "http://keycloak:8080"
  KEYCLOAK_REALM: "online-beratung"
  IDENTITY_OPENID_CONNECT_URL: "http://keycloak:8080/realms/online-beratung/protocol/openid-connect"
  SPRING_SECURITY_OAUTH2_RESOURCESERVER_JWT_ISSUER_URI: "http://keycloak:8080/realms/online-beratung"
  SPRING_SECURITY_OAUTH2_RESOURCESERVER_JWT_JWK_SET_URI: "http://keycloak:8080/realms/online-beratung/protocol/openid-connect/certs"
  
  # Service URLs - Use service names
  CONSULTING_TYPE_SERVICE_API_URL: "http://consultingtypeservice:8083"
  TENANT_SERVICE_API_URL: "http://tenantservice:8081"
  AGENCY_SERVICE_API_URL: "http://agencyservice:8084"
  APPOINTMENT_SERVICE_API_URL: ""
  LIVE_SERVICE_API_URL: ""
  
  # Rocket.Chat Configuration - Legacy (DISABLED - migrated to Matrix)
  # Dummy values required to satisfy Spring Boot validation - RocketChat is not deployed
  # The scheduler using RocketChat is disabled via session.inactive.deleteWorkflow.enabled=false
  ROCKET_CHAT_BASE_URL: "http://localhost:3000/api/v1"
  ROCKET_CHAT_MONGO_URL: "mongodb://localhost:27017/rocketchat?retryWrites=false"
  
  # Disable RocketChat-dependent schedulers
  SESSION_INACTIVE_DELETEWORKFLOW_ENABLED: "false"
  
  # Matrix Configuration - Use service names
  MATRIX_API_URL: "http://matrix-synapse:8008"
  MATRIX_SERVER_NAME: "caritas.local"
  
  # RabbitMQ Configuration - Use service names
  SPRING_RABBITMQ_HOST: "rabbitmq"
  SPRING_RABBITMQ_PORT: "5672"
  
  # MongoDB Configuration - Use service names
  SPRING_DATA_MONGODB_URI: "mongodb://mongodb:27017/userservice"
  
  # CORS Configuration - Update with your domain/IP
  REGISTRATION_CORS_ALLOWED_ORIGINS: "https://app.oriso.site,https://api.oriso.site"
  
  # Spring Profile - Use local profile (application-local.properties)
  SPRING_PROFILES_ACTIVE: "local"
  
  # Liquibase - Explicitly disabled (database schemas managed separately in ORISO-Database)
  SPRING_LIQUIBASE_ENABLED: "false"

